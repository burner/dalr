module dalr.main;

import dalr.dotfilewriter;
import dalr.grammerparser;
import dalr.productionmanager;
import dalr.symbolmanager;
import dalr.finalitem;

import hurt.container.deque;
import hurt.io.stdio;
import hurt.util.slog;

void main() {
	SymbolManager sm = new SymbolManager();
	GrammerParser gp = new GrammerParser(sm);
	ProductionManager pm = new ProductionManager(sm);
	//pm.insertProduction(gp.processProduction("S := N"));
	//pm.insertProduction(gp.processProduction("N := V = E"));
	//pm.insertProduction(gp.processProduction("N := E"));
	//pm.insertProduction(gp.processProduction("E := V"));
	//pm.insertProduction(gp.processProduction("V := x"));
	//pm.insertProduction(gp.processProduction("V := * E"));
	pm.insertProduction(gp.processProduction("A := A + A"));
	pm.insertProduction(gp.processProduction("A := A * A"));
	pm.insertProduction(gp.processProduction("A := A - A"));
	pm.insertProduction(gp.processProduction("A := a"));
	pm.makeLRZeroItemSets();
	writeLR0Graph(pm.getItemSets(), sm, pm.getProductions(), "lr0");
	log();
	pm.makeExtendedGrammer();
	log();
	print(pm.extendedGrammerToString());
	log();
	pm.makeNormalFirstSet();
	log();
	//print(pm.normalFirstSetToString());
	pm.makeExtendedFirstSet();
	log();
	//print(pm.extendedFirstSetToString());
	pm.makeNormalFollowSet();
	log();
	println(pm.normalFollowSetToString());
	log();
	println(pm.extendedGrammerItemsToString());
	log();
	pm.makeExtendedFollowSet();
	log();
	println(pm.extendedFollowSetToString());
	log();
	pm.getTranslationTable();
	log();
	pm.getFinalTable();
	log();
	println(pm.toString());
	log();
	println(pm.transitionTableToString());
	log();
	println(pm.mergedExtendedToString());
	log();
	//println(pm.extendedFollowSetToString());
	//pm.reduceExtGrammerFollow();
	println(pm.extFollowRulesToString());
	log();
	println(pm.finalTransitionTableToString());
	log();
	log();
}
